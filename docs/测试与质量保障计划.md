# 测试与质量保障计划

## 1. 测试目标
确保实时翻译系统在演讲者、观众、后台三端的核心功能按预期运行，满足性能、可靠性与兼容性要求，为上线提供质量保障。

## 2. 测试范围
- 功能测试：需求规格中的所有功能点，包括二维码生成/失效流程。
- 性能测试：WebSocket 并发、翻译延迟。
- 兼容性测试：主流桌面与移动浏览器（真机测试将在后续阶段另行安排）。
- 安全测试：认证、授权、API 防护。
- 回归测试：每次发布前的关键流程验证。

## 3. 测试策略
### 3.1 单元测试
- 前端：使用 Vitest + Vue Testing Library 覆盖组件、工具函数。
- 后端：使用 testify 覆盖业务逻辑（活动管理、令牌生成、消息序列化、二维码生成）。
- 目标覆盖率：核心模块≥70%。

### 3.2 集成测试
- 后端模拟 Google API（使用 WireMock 或自动化脚本）验证翻译管线。
- 前后端集成：使用 Cypress 或 Playwright 模拟演讲者推流、观众接收、后台 CRUD 与二维码下载。
- QR 场景：验证活动创建成功页二维码展示与下载、活动关闭后二维码失效提示。
- 移动端真机测试计划将于后续阶段单独制定。

### 3.3 性能测试
- 工具：k6 / Locust。
- 场景：
  1. 1 名演讲者持续推送音频 30 分钟。
  2. 30 名观众同时订阅不同语言频道。
- 指标：
  - 平均/最大翻译延迟；
  - WebSocket 吞吐；
  - 后端 CPU/内存占用。
- 验收标准：翻译完成时间≤5 秒；错误率≤1%。

### 3.4 兼容性测试
- 桌面：Chrome、Firefox、Edge、Safari 最新版本。
- 移动端：当前阶段通过浏览器调试与有限真机抽测验证关键流程；完整真机覆盖放入后续计划。
- 检查：录音权限、字幕滚动体验、屏幕旋转适配、二维码加载。

### 3.5 安全测试
- 验证 JWT 鉴权、令牌过期处理。
- 检查常见漏洞：XSS、CSRF（采用 SameSite Cookie、Origin 验证）、SQL 注入（若有数据库）。
- API 频率限制测试，模拟暴力请求。
- 验证二维码失效后访问提示的正确性。

### 3.6 可用性测试
- 小范围用户测试，收集演讲者与观众对界面/延迟的反馈。
- 记录操作路径、问题点，迭代优化。
- 移动端体验调研列入后续阶段的专项任务。

## 4. 测试流程
1. 需求评审与测试用例编写。
2. 开发自测（单元 + 本地集成）。
3. 提交合并请求，触发 CI 自动测试（单元/集成）。
4. QA 执行手工测试与性能测试。
5. 输出测试报告，评估是否符合上线标准。
6. 上线后监控与回归验证。

## 5. 测试用例示例
- 演讲者端：
  - 语种切换后翻译语言是否同步更新。
  - WebSocket 中断后自动重连是否成功。
- 观众端：
  - 语言切换后历史字幕刷新是否正确。
  - 断网后提示与恢复逻辑。
  - 二维码失效时显示提示并阻止进入活动。
- 后台端：
  - 新增活动字段校验与成功页二维码渲染。
  - 生成邀请码有效期与并发限制。
  - 手动失效二维码后无法再使用旧链接进入。

## 6. 缺陷管理
- 使用 GitHub Issues 或 Jira 记录缺陷。
- 缺陷描述包含：版本、重现步骤、期望 vs 实际、日志截取。
- 严重级别：致命/严重/一般/建议。
- 生命周期：打开 → 处理中 → 待验证 → 关闭。

## 7. 验收标准
- 所有 Must-have 需求测试通过。
- 严重级别缺陷数为 0。
- 性能指标达成（翻译延迟、并发稳定）。
- 安全扫描无高危风险。
- 二维码生成/失效流程在桌面端验证通过，真机测试结果待后续阶段补充。

## 8. 上线后质量保证
- 监控上线后 24 小时内的错误日志与性能指标。
- 预备回滚方案（docker-compose 回滚、备份配置）。
- 收集用户反馈，计划下一轮迭代测试，包含移动端专项验证。
