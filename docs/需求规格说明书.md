# 需求规格说明书

## 1. 项目背景
Orion 是一个面向单场演讲场景的实时语音翻译 Web 应用。演讲者通过浏览器上传语音流，后端调用 Google Speech-to-Text 与 Cloud Translation 在完成一句话识别后，将译文推送给观众端，支持 20-30 名观众同时在线。系统分为演讲者端、观众端和后台管理端三个独立的前端项目，与统一的后端服务通过 REST API 与 WebSocket 通信。

## 2. 项目目标
- 演讲者可以在 Web 前端选择输入语种并实时看到识别结果与译文。
- 观众可以在 Web 前端（移动端优先）选择目标语种并实时收到对应语言的字幕。
- 后台管理员维护活动信息（简介、主讲人、图片、时间等），控制演讲者与观众访问权限并生成观众端二维码链接。
- 系统支持移动端浏览器访问，提供逐句级别的实时翻译体验。

## 3. 项目范围
- **包含**：
  - 演讲者端语音捕获、语种选择、原文与译文实时展示。
  - 观众端语言选择、字幕显示、历史字幕回滚（短期缓存）、二维码扫码进入。
  - 后台端活动 CRUD、人员访问控制、资源管理、观众端链接及二维码生成。
  - 后端实时翻译服务、WebSocket 管理、Google API 对接。
  - 部署于 AWS EC2，使用 Docker 进行基础容器化。
- **不包含**：
  - 多场演讲并行处理。
  - 人工审核或编辑翻译结果。
  - 长期存储演讲原文/译文记录。
  - 原生移动 App、桌面客户端。

## 4. 用户角色与场景
| 角色 | 核心目标 | 关键操作 |
| --- | --- | --- |
| 演讲者 | 将演讲内容实时翻译并展示给观众 | 登录 → 选择活动 → 选择输入语种 → 开始推送语音 → 查看原文/译文 |
| 观众 | 接收指定语种的字幕 | 扫描二维码或输入邀请码 → 选择目标语言 → 实时观看字幕 → 查看最近字幕历史 |
| 后台管理员 | 管理活动与访问权限 | 登录后台 → 创建/编辑活动 → 生成观众二维码与令牌 |

## 5. 功能需求
### 5.1 演讲者端
1. 登录并选择需要参与的活动。
2. 选择语音输入语种（从后台预设列表中选择）。
3. 浏览器获取麦克风权限，实时发送音频至后端。
4. 实时展示识别出的原文字幕（逐句）。
5. 同步展示对应语言的译文（至少一个默认语言，以后台配置为准）。
6. 查看当前 WebSocket 连接状态与基本故障提示。

### 5.2 观众端
1. 扫描后台生成的二维码或输入活动邀请码进入对应活动。
2. 选择目标语言（主流语言列表，可动态切换）。
3. 实时接收该语言的译文字幕。
4. 查看最近 5 分钟的字幕历史，并可向上滚动回看。
5. 获取连接状态提示，必要时指导用户重连或降级到仅文本模式。
6. 页面采用移动优先布局，支持手机竖屏与横屏浏览。

### 5.3 后台管理端
1. 管理员登录与权限校验（单一管理员）。
2. 活动管理：创建、编辑、发布、关闭，维护活动标题、简介、主讲人、封面图片、演讲时间、默认输入语种、可选目标语种列表。
3. 人员控制：生成演讲者访问令牌、观众邀请码，设置有效期与最大并发数。
4. 资源管理：上传封面图片或介绍素材，存储在对象存储或 CDN。
5. 自动生成观众端访问链接与二维码，并提供下载/导出功能。
6. 查看基础使用统计（总观众数、按语言订阅数、连接状态）——用于后续扩展，可提供预留接口。

## 6. 非功能性需求
### 6.1 性能
- 观众并发 20-30 人，WebSocket 连接稳定，无明显延迟或丢包。
- 逐句翻译延迟控制在 2-5 秒内（受语音断句与 Google 服务影响）。

### 6.2 可用性
- 支持最新主流浏览器（Chrome、Firefox、Safari、Edge）桌面与移动端。
- 观众端采用移动优先策略，重点优化手机端体验（加载速度、触控交互、字体可读性）。
- 提供基础的网络状态提示与重连机制。

### 6.3 安全
- 全站 HTTPS，WebSocket 使用 WSS。
- API Key、令牌等敏感信息通过环境变量与安全存储管理。
- JWT 或邀请码方式控制访问权限。

### 6.4 可维护性
- 前后端分离，模块化设计，统一使用 TypeScript 与 Go 增强类型安全。
- 提供完整文档与 CI 流程基础配置，便于团队协作与扩展。

## 7. 目标语言列表
默认支持以下主流语言，可在后台配置增删：
- 英语（en）
- 中文（简体 zh-CN / 繁体 zh-TW）
- 日语（ja）
- 韩语（ko）
- 西班牙语（es）
- 法语（fr）
- 德语（de）
- 意大利语（it）
- 葡萄牙语（pt）
- 俄语（ru）

## 8. 约束与假设
- 演讲者端仅需支持单一演讲者，活动时间不重叠。
- 后端依赖 Google Speech-to-Text 与 Translation API，需保证配额充足。
- 短期不落地存储完整字幕，仅保留内存或临时缓存以支持历史查看。
- 部署环境为 AWS EC2，操作系统使用 Ubuntu LTS。

## 9. 风险与应对
| 风险 | 影响 | 应对策略 |
| --- | --- | --- |
| Google 服务延迟或不稳定 | 字幕延迟增加 | 设置超时与重试策略，提供状态提示 |
| 浏览器录音权限被拒绝 | 演讲者无法推送语音 | 引导用户授予权限，提供重试按钮 |
| 移动端网络波动 | 字幕断流或延迟 | WebSocket 心跳与断线重连机制，降级提示 |
| API Key 泄露 | 服务失效或被滥用 | 使用安全存储、最小权限、定期轮换 |

## 10. 后续扩展方向
- 支持演讲录制与历史字幕存档。
- 引入多场演讲并行及多演讲者协作。
- 提供 AI 辅助的语音噪音过滤与句子优化。
- 增加运维监控与告警机制。
